{{- include "eneo.validateValues" . -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "eneo.fullname" . }}-secrets
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "eneo.labels" . | nindent 4 }}
type: Opaque
stringData:
  # Auto-generated security keys (generated once, then preserved on upgrades)
  JWT_SECRET: {{ include "eneo.generateJwtSecret" (dict "value" .Values.secrets.jwtSecret "context" .) | quote }}
  URL_SIGNING_KEY: {{ include "eneo.generateUrlSigningKey" (dict "value" .Values.secrets.urlSigningKey "context" .) | quote }}
  ENCRYPTION_KEY: {{ include "eneo.generateEncryptionKey" (dict "value" .Values.secrets.encryptionKey "context" .) | quote }}
  
  # Public configuration - derived from global.domain
  PUBLIC_ORIGIN: {{ printf "https://%s" .Values.global.domain | quote }}
  
  # OIDC Configuration
  OIDC_DISCOVERY_ENDPOINT: {{ .Values.oidc.discoveryUrl | quote }}
  OIDC_CLIENT_ID: {{ .Values.oidc.clientId | quote }}
  OIDC_CLIENT_SECRET: {{ .Values.oidc.clientSecret | quote }}
  OIDC_TENANT_ID: {{ .Values.oidc.tenantId | quote }}
  
  # LLM API Keys
  GDM_API_KEY: {{ .Values.secrets.gdmApiKey | quote }}
  OPENAI_API_KEY: {{ .Values.secrets.openaiApiKey | quote }}
  ANTHROPIC_API_KEY: {{ .Values.secrets.anthropicApiKey | quote }}
  GEMINI_API_KEY: {{ .Values.secrets.geminiApiKey | quote }}
  AZURE_API_KEY: {{ .Values.secrets.azureApiKey | quote }}
  AZURE_ENDPOINT: {{ .Values.secrets.azureEndpoint | quote }}
  AZURE_API_BASE: {{ .Values.secrets.azureApiBase | quote }}
  AZURE_MODEL_DEPLOYMENT: {{ .Values.secrets.azureModelDeployment | quote }}
  MISTRAL_API_KEY: {{ .Values.secrets.mistralApiKey | quote }}
  OVHCLOUD_API_KEY: {{ .Values.secrets.ovhcloudApiKey | quote }}
  BERGET_API_KEY: {{ .Values.secrets.bergetApiKey | quote }}
  BERGET_API_BASE: {{ .Values.secrets.bergetApiBase | quote }}
  FLUX_API_KEY: {{ .Values.secrets.fluxApiKey | quote }}
  TAVILY_API_KEY: {{ .Values.secrets.tavilyApiKey | quote }}
  VLLM_MODEL_URL: {{ .Values.secrets.vllmModelUrl | quote }}
  VLLM_API_KEY: {{ .Values.secrets.vllmApiKey | quote }}
  INFINITY_URL: {{ .Values.secrets.infinityUrl | quote }}
  
  # Default tenant/user configuration
  DEFAULT_TENANT_NAME: {{ .Values.secrets.defaultTenantName | quote }}
  DEFAULT_TENANT_QUOTA_LIMIT: {{ .Values.secrets.defaultTenantQuotaLimit | quote }}
  DEFAULT_USER_NAME: {{ .Values.secrets.defaultUserName | quote }}
  DEFAULT_USER_EMAIL: {{ .Values.secrets.defaultUserEmail | quote }}
  DEFAULT_USER_PASSWORD: {{ .Values.secrets.defaultUserPassword | quote }}
  
  # Internal services - auto-generated
  INTRIC_MARKETPLACE_API_KEY: {{ .Values.secrets.intricMarketplaceApiKey | quote }}
  INTRIC_MARKETPLACE_URL: {{ .Values.secrets.intricMarketplaceUrl | quote }}
  INTRIC_SUPER_API_KEY: {{ include "eneo.generateIntricSuperApiKey" (dict "value" .Values.secrets.intricSuperApiKey "context" .) | quote }}
  INTRIC_SUPER_DUPER_API_KEY: {{ include "eneo.generateIntricSuperDuperApiKey" (dict "value" .Values.secrets.intricSuperDuperApiKey "context" .) | quote }}
  
  # OAuth Integration
  OAUTH_CALLBACK_URL: {{ .Values.secrets.oauthCallbackUrl | quote }}
  CONFLUENCE_CLIENT_ID: {{ .Values.secrets.confluenceClientId | quote }}
  CONFLUENCE_CLIENT_SECRET: {{ .Values.secrets.confluenceClientSecret | quote }}
  SHAREPOINT_CLIENT_ID: {{ .Values.secrets.sharepointClientId | quote }}
  SHAREPOINT_CLIENT_SECRET: {{ .Values.secrets.sharepointClientSecret | quote }}
  
  # Legacy auth (deprecated)
  MOBILITYGUARD_DISCOVERY_ENDPOINT: {{ .Values.secrets.mobilityguardDiscoveryEndpoint | quote }}
  MOBILITYGUARD_CLIENT_ID: {{ .Values.secrets.mobilityguardClientId | quote }}
  MOBILITYGUARD_CLIENT_SECRET: {{ .Values.secrets.mobilityguardClientSecret | quote }}
  MOBILITYGUARD_TENANT_ID: {{ .Values.secrets.mobilityguardTenantId | quote }}
